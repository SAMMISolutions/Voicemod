const voicesParametersArticle=$("#voicesParametersArticle"),voicesParametersArticleSelect=voicesParametersArticle.find("#setCurrentVoiceParameter-parameterName"),voiceParametersManager={currentVoiceId:"",currentVoiceParameters:{}};voiceParametersManager.onVoiceChange=e=>{if(!e)return;voiceParametersManager.currentVoiceId=e.voiceId,voiceParametersManager.currentVoiceParameters=e.parameters,voicesParametersArticleSelect.html("");let a=!0;for(let t in e.parameters)a&&(setParameterValues(e.parameters[t]),a=!1),voicesParametersArticleSelect.append(`<option val="${t}">${t}</option>`)},voiceParametersManager.onParameterChange=e=>{let a=toCamelCase(e.parameter.name),t=voiceParametersManager.currentVoiceParameters[a];t&&(t.value=e.parameter.value,a===voicesParametersArticleSelect.val()&&setParameterValues(t))},voicesParametersArticleSelect.change(()=>{let e=voiceParametersManager.currentVoiceParameters[voicesParametersArticleSelect.val()];e&&setParameterValues(e)});const setParameterValues=e=>{e&&($("#setCurrentVoiceParameter-maxValue").val(e.maxValue),$("#setCurrentVoiceParameter-minValue").val(e.minValue),$("#setCurrentVoiceParameter-value").val(e.value),$("#setCurrentVoiceParameter-displayNormalized").attr("checked",e.displayNormalized))};jQuery("#setCurrentVoiceParameters").click(()=>{let e={parameterName:$("#setCurrentVoiceParameter-parameterName").val(),parameterValue:{maxValue:parseFloat($("#setCurrentVoiceParameter-maxValue").val()),minValue:parseFloat($("#setCurrentVoiceParameter-minValue").val()),displayNormalized:$("#setCurrentVoiceParameter-displayNormalized").is(":checked"),value:parseFloat($("#setCurrentVoiceParameter-value").val())}};console.log("sending",e),Voicemod.sendMessageToServer("setCurrentVoiceParameter",e)});const toCamelCase=e=>{if(e&&"string"==typeof e)return`${e[0].toLowerCase()}${e.substr(1)}`};var Voicemod=function(){var e=!1,a=!1,t=!1,r=!1,n=!1,c=!1;let o=null;var i="free",s="???",l={},u=-1,m=!1,g={uri:"ws://localhost",port:[59129,2e4,39273,42152,43782,46667,35679,37170,38501,33952,30546],path:"/v1",autoRetry:!1,onConnect:null,onDisconnect:null,onError:null,onMessage:null,onDebug:null},d=function(){if(!m){m=!0,++u>g.port.length-1&&(u=0);var e=g.uri+":"+g.port[u]+g.path;try{(websocket=new WebSocket(e)).onopen=b,websocket.onclose=v,websocket.onmessage=P,websocket.onerror=p}catch(a){v()}}},b=function(e){null!=g.onConnect&&g.onConnect()},v=function(e){m=!1,null!=g.onDisconnect&&g.onDisconnect(),g.autoRetry&&setTimeout(function(){d()},250)},p=function(e){null!=g.onError&&g.onError()},f=function(e){return"string"==typeof e?JSON.parse(e):e},P=function(u){if(u.data&&((message=JSON.parse(u.data)).actionType||message.action)){var m=message.actionType||message.action;switch(m){case"registerClient":(message.actionObject||message.payload)&&(message.actionObject&&(i=message.actionObject.licenseType),vmUpdateUI());break;case"toggleBackground":e=message.actionObject.value,vmUpdateUI();break;case"toggleHearMyVoice":a=message.actionObject.value,vmUpdateUI();break;case"toggleVoiceChanger":c=message.actionObject.value,vmUpdateUI();break;case"toggleMuteMemeForMe":r=message.actionObject.value,vmUpdateUI();break;case"toggleMuteMic":t=message.actionObject.value,vmUpdateUI();break;case"getUserLicense":i=message.actionObject.licenseType,vmUpdateUI();break;case"getVoices":case"getBitmap":break;case"backgroundEffectsEnabledEvent":e=!0,vmUpdateUI();break;case"backgroundEffectsDisabledEvent":e=!1,vmUpdateUI();break;case"muteMicrophoneEnabledEvent":t=!0,vmUpdateUI();break;case"muteMicrophoneDisabledEvent":t=!1,vmUpdateUI();break;case"muteMemeForMeEnabledEvent":r=!0,vmUpdateUI();break;case"muteMemeForMeDisabledEvent":r=!1,vmUpdateUI();break;case"badLanguageEnabledEvent":n=!0,vmUpdateUI();break;case"badLanguageDisabledEvent":n=!1,vmUpdateUI();break;case"HearMyVoiceEnabledEvent":a=!0,vmUpdateUI();break;case"HearMyVoiceDisabledEvent":a=!1,vmUpdateUI();break;case"getActiveSoundboardProfile":o=message.payload.profileId,vmUpdateUI();break;case"voiceChangerEnabledEvent":c=!0,vmUpdateUI();break;case"voiceChangerDisabledEvent":c=!1,vmUpdateUI();break;case"getCurrentVoice":s=message.payload.voiceId,voiceParametersManager.onVoiceChange(message.payload),vmUpdateUI();break;case"voiceParameterUpdated":voiceParametersManager.onParameterChange(message.payload);break;case"licenseTypeChangedEvent":message.actionObject&&(message.actionObject=f(message.actionObject),i=message.actionObject.licenseType,vmUpdateUI());break;case"voiceLoadedEvent":message.actionObject&&(message.actionObject=f(message.actionObject),s=message.actionObject.voiceID,vmUpdateUI()),voiceParametersManager.onVoiceChange(message.payload);break;case"parametersChangedEvent":case"parameterChangedEvent":if(message.actionObject){if(message.actionObject=f(message.actionObject),"custom"==message.actionObject.voiceID)return;l=message.actionObject.parameters}}null!=g.onMessage&&(message.actionType?g.onMessage(message.actionType,message.actionObject,message.actionID):g.onMessage(message.action,message.payload))}},V=function(e){websocket.send(e)};return this.sendMessageToServer=function(e,a=null,t=100,r=""){var n,c={};switch(e){case"registerClient":c.clientKey=a;break;case"getVoiceBitmap":c.voiceID=a,e="getBitmap";break;case"getMemeBitmap":c.memeId=a,e="getBitmap";break;case"playMeme":c.FileName=a,c.IsKeyDown=!0;break;case"selectVoice":case"loadVoice":"string"==typeof a?(c.voiceID=a,c.voiceId=a):c=a;break;case"toggleMuteMic":c.toggleMute=a;break;case"toggleVoiceChanger":null!=a&&(c.toggleVoiceChanger=a);break;case"setBeepSound":c.badLanguage=a;break;default:null!=a&&(c=a)}"/v1"===g.path?n={id:t,payload:c,action:e}:"/vmsd"===g.path&&(n={actionId:t,actionType:e,pluginVersion:"v1",context:c}),V(JSON.stringify(n))},this.init=function(e={}){g=Object.assign({},g,e),connect()},this.connect=function(){d()},this.disconnect=function(){m&&websocket.close()},Object.defineProperty(this,"backgroundEnabled",{get:function(){return e}}),Object.defineProperty(this,"hearMyVoiceEnabled",{get:function(){return a}}),Object.defineProperty(this,"voiceChangerEnabled",{get:function(){return c}}),Object.defineProperty(this,"badLanguageEnabled",{get:function(){return n}}),Object.defineProperty(this,"muteMemeForMeEnabled",{get:function(){return r}}),Object.defineProperty(this,"licenseType",{get:function(){return i}}),Object.defineProperty(this,"muted",{get:function(){return t}}),Object.defineProperty(this,"port",{get:function(){return g.port},set:function(e){u=-1,g.port=e}}),Object.defineProperty(this,"currentVoice",{get:function(){return s}}),Object.defineProperty(this,"isConnected",{get:function(){return m}}),Object.defineProperty(this,"currentlyActiveSoundboardProfile",{get:function(){return o}}),this}();